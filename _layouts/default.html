---
layout: default
title: notifications
---

<style>
  body { font-family: Arial, sans-serif; padding: 2rem; text-align: center; }
  #content { display: none; }
  #blocked { display: none; color: red; }
  #ask-permission { padding: 0.5rem 1rem; font-size: 1rem; cursor: pointer; }
</style>

<div id="content">
  <h1>Welcome to the Exclusive Page!</h1>
  <p>Since you have enabled notifications, you can access this content.</p>
</div>

<div id="blocked">
  <h1>Notifications Required</h1>
  <p>Please enable push notifications to access this page.</p>
  <button id="ask-permission">Enable Notifications</button>
</div>

<script>
  // Ensure the DOM is fully loaded before running the script
  document.addEventListener('DOMContentLoaded', function() {
    // Ensure OneSignal is loaded
    if (typeof OneSignal === "undefined") {
      console.error("OneSignal SDK not found. Please ensure it's loaded in your <head> tag.");
      // Fallback for when the SDK isn't available
      document.getElementById('content').style.display = 'none';
      document.getElementById('blocked').style.display = 'block';
      return;
    }

    // Function to update page visibility based on subscription status
    function updateContent(isEnabled) {
      const contentDiv = document.getElementById('content');
      const blockedDiv = document.getElementById('blocked');

      if (isEnabled) {
        if (blockedDiv) blockedDiv.style.display = 'none';
        if (contentDiv) contentDiv.style.display = 'block';
      } else {
        if (contentDiv) contentDiv.style.display = 'none';
        if (blockedDiv) blockedDiv.style.display = 'block';
      }
    }

    // Use OneSignal's deferred array to ensure the code runs after initialization
    window.OneSignalDeferred = window.OneSignalDeferred || [];
    window.OneSignalDeferred.push(async function(OneSignal) {
      // Initialize OneSignal with your app ID
      await OneSignal.init({
        appId: "ee9cfc93-71c9-41e0-a30c-20662ea9937f",
        safari_web_id: "web.onesignal.auto.204803f7-478b-4564-9a97-0318e873c676",
        notifyButton: { enable: true }
      });

      // Check the initial push notification status
      const isEnabled = await OneSignal.isPushNotificationsEnabled();
      updateContent(isEnabled);

      // Add a listener for when the subscription status changes
      OneSignal.on('subscriptionChange', function(isSubscribed) {
        updateContent(isSubscribed);
      });

      // Add click event to the "Enable Notifications" button
      const askPermissionBtn = document.getElementById('ask-permission');
      if (askPermissionBtn) {
        askPermissionBtn.addEventListener('click', function() {
          OneSignal.showSlidedownPrompt();
        });
      }
    });
  });
</script>